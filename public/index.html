<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>KUSUMA AI</title>
<style>
  /* ======= Tema Galaxy ======= */
  :root{
    --bg:#000010; --panel:rgba(20,20,35,0.9); --text:#e6edf3;
    --bubble-ai:#6f42c1; --bubble-user:#1e90ff;
    --glow:#8a2be2; --shadow:0 10px 30px rgba(0,0,0,.45);
  }
  body{
    margin:0; font-family:Poppins,system-ui,Segoe UI,Roboto,Arial;
    height:100vh; display:flex; flex-direction:column;
    background: radial-gradient(circle at 20% 30%, #1a0033, #000010 70%),
                url("https://www.transparenttextures.com/patterns/stardust.png");
    color:var(--text);
    overflow:hidden;
  }

  /* ======= Sidebar ======= */
  #sidebar{
    position:fixed; top:0; left:-240px; width:220px; height:100%;
    background:var(--panel); box-shadow:2px 0 20px rgba(0,0,0,.6);
    transition:0.3s ease; padding:20px; z-index:1001;
    display:flex; flex-direction:column; gap:16px;
  }
  #sidebar.active{left:0;}
  #sidebar h2{margin:0 0 20px; text-align:center; color:#fff; text-shadow:0 0 10px var(--glow);}
  #sidebar button{
    padding:12px; border:none; border-radius:10px; margin:4px 0;
    background:var(--glow); color:#fff; font-weight:600; cursor:pointer;
    box-shadow:0 0 14px var(--glow);
  }

  /* ======= Header ======= */
  header{
    position:sticky; top:0; z-index:10;
    display:flex; align-items:center; justify-content:flex-start;
    background:rgba(0,0,0,.4); padding:14px 16px; backdrop-filter: blur(6px);
  }
  #menuBtn{font-size:22px; cursor:pointer; background:none; border:none; color:var(--text);}
  h1{margin-left:10px; font-size:20px; text-shadow:0 0 14px var(--glow)}

  main{flex:1; overflow-y:auto; padding:14px;}

  /* Chat */
  #chatPage{display:none; flex-direction:column; height:100%;}
  #chat{flex:1; overflow-y:auto; padding:18px 14px; display:flex; flex-direction:column; gap:12px;}
  .row{display:flex; gap:10px; align-items:flex-end}
  .row.user{justify-content:flex-end}
  .row .avatar{width:36px; height:36px; border-radius:50%; flex:0 0 auto}
  .row .avatar img{width:100%; height:100%; border-radius:50%}
  .bubble{
    max-width:72%; padding:12px 14px; border-radius:16px; line-height:1.5;
    background:var(--panel); color:var(--text); box-shadow:var(--shadow);
    white-space:pre-wrap;
  }
  .row.ai .bubble{background:var(--bubble-ai); color:#fff; border-bottom-left-radius:6px}
  .row.user .bubble{background:var(--bubble-user); color:#fff; border-bottom-right-radius:6px}
  #bar{display:flex; gap:10px; padding:12px; background:rgba(0,0,0,.25); border-top:1px solid rgba(255,255,255,.06);}
  #prompt{flex:1; padding:12px 14px; border-radius:12px; border:1px solid rgba(255,255,255,.15); background:var(--panel); color:var(--text);}
  #send{padding:12px 18px; border:none; border-radius:12px; cursor:pointer; font-weight:700; background:var(--glow); color:#fff; box-shadow:0 0 16px var(--glow);}

  /* Dashboard */
  #dashboardPage{display:flex; flex-direction:column; align-items:center; justify-content:center; gap:20px; height:100%;}
  #dashboardPage button{padding:14px 20px; border-radius:14px; border:none; font-weight:700; cursor:pointer; background:var(--glow); box-shadow:0 0 14px var(--glow); color:#fff;}

  /* History */
  #historyPage{display:none;}
  .history-item{background:var(--panel); padding:10px; border-radius:10px; margin:8px 0; box-shadow:var(--shadow);}

  /* Profile */
  #profilePage{display:none; text-align:center;}
  #profilePage img{width:100px; height:100px; border-radius:50%; margin-bottom:10px;}
  #profilePage input{padding:10px; border-radius:10px; border:1px solid rgba(255,255,255,.15); background:var(--panel); color:var(--text); margin:5px 0;}

  /* Modal notif */
  #notif{position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,20,0.85); display:flex; align-items:center; justify-content:center; z-index:1000;}
  #notif .box{background:var(--panel); padding:20px; border-radius:14px; text-align:center; box-shadow:0 0 20px var(--glow); max-width:300px;}
  #notif img{width:80px; height:80px; border-radius:50%; margin-bottom:12px}
  #notif button{margin-top:12px; padding:10px 16px; border:none; border-radius:10px; background:var(--glow); font-weight:700; cursor:pointer; color:#fff;}
</style>
</head>
<body>
  <!-- Sidebar -->
  <div id="sidebar">
    <h2>‚òÑÔ∏è KUSUMA AI</h2>
    <button onclick="showPage('dashboardPage')">Dashboard</button>
    <button onclick="showPage('chatPage')">Chat</button>
    <button onclick="showPage('historyPage')">History</button>
    <button onclick="showPage('profilePage')">Profile</button>
  </div>

  <!-- Header -->
  <header>
    <button id="menuBtn">‚ò∞</button>
    <h1>KUSUMA AI</h1>
  </header>

  <main>
    <!-- Dashboard -->
    <div id="dashboardPage">
      <h2>üåå Selamat Datang di Kusuma Ai</h2>
      <button onclick="showPage('chatPage')">Mulai Chat</button>
      <button onclick="showPage('historyPage')">Lihat History </button>
      <button onclick="showPage('profilePage')">Profil Saya </button>
    </div>

    <!-- Chat -->
    <div id="chatPage">
      <div id="chat"></div>
      <div id="bar">
        <input id="prompt" placeholder="Ketik pesan..." autocomplete="off"/>
        <button id="send">Kirim</button>
      </div>
    </div>

    <!-- History -->
    <div id="historyPage">
      <h2>Riwayat Chat üå†</h2>
      <div id="historyList"></div>
    </div>

    <!-- Profile -->
    <div id="profilePage">
      <h2>Profil Saya üë®‚ÄçüöÄ</h2>
      <img id="profilePic" src="https://files.catbox.moe/55ojop.jpg"/>
      <div>
        <input id="profileName" placeholder="Nama Anda"/>
        <button onclick="saveProfile()">Simpan</button>
      </div>
    </div>
  </main>

  <!-- Notifikasi awal -->
  <div id="notif">
    <div class="box">
      <img src="https://files.catbox.moe/v25xqs.jpg" alt="AI">
      <h2>Welcome!!</h2>
      <p>I Am Kusuma AI Created To Help You üåå</p>
      <button onclick="closeNotif()">Mulai</button>
    </div>
  </div>

<script>
const chat=document.getElementById('chat');
const promptEl=document.getElementById('prompt');
const sendBtn=document.getElementById('send');
const notif=document.getElementById('notif');

const AV_AI="https://files.catbox.moe/v25xqs.jpg";
let AV_USER="https://files.catbox.moe/55ojop.jpg";
let USER_NAME="Guest";

// Sidebar
const sidebar=document.getElementById("sidebar");
document.getElementById("menuBtn").addEventListener("click",()=>{
  sidebar.classList.toggle("active");
});

// Ganti halaman
function showPage(id){
  document.querySelectorAll("main > div").forEach(p=>p.style.display="none");
  document.getElementById(id).style.display=id==="chatPage"?"flex":"block";
  if(id==="historyPage") renderHistory();
  if(id==="profilePage") loadProfile();
  sidebar.classList.remove("active");
}
function closeNotif(){notif.style.display='none'; promptEl.focus();}

// Buat bubble chat
function rowEl(side){
  const r=document.createElement('div'); r.className='row '+side;
  const avatar=document.createElement('div'); avatar.className='avatar';
  const img=document.createElement('img'); img.src=side==='ai'?AV_AI:AV_USER;
  avatar.appendChild(img);
  const bubble=document.createElement('div'); bubble.className='bubble';
  r.appendChild(side==='ai'?avatar:bubble);
  r.appendChild(side==='ai'?bubble:avatar);
  return {r,bubble};
}
function addMessage(text,side){
  const {r,bubble}=rowEl(side);
  bubble.textContent=text;
  chat.appendChild(r);
  r.scrollIntoView({ behavior: "smooth", block: "end" });
  saveHistory(text,side);
}

// Kirim pesan
async function sendMessage(text){
  if(!text){text=promptEl.value.trim();}
  if(!text) return;
  addMessage(text,'user');
  promptEl.value=""; promptEl.focus();

  try{
    const res=await fetch('/ai',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({ text })
    });
    const data=await res.json();
    let answer=data.text || "‚ö†Ô∏è Tidak menemukan jawaban.";
    answer = answer.replace(/\\n/g, "\n").replace(/n\\/g, "\n");
    addMessage(answer,'ai');
  }catch(err){
    addMessage("‚ùå Error mengambil jawaban dari server.",'ai');
  }
}
sendBtn.addEventListener('click',()=>sendMessage());
promptEl.addEventListener('keydown',e=>{if(e.key==='Enter')sendMessage();});

// History pakai localStorage
function saveHistory(text,side){
  let history=JSON.parse(localStorage.getItem("kusuma_history")||"[]");
  history.push({side,text,time:Date.now()});
  localStorage.setItem("kusuma_history",JSON.stringify(history));
}
function renderHistory(){
  const list=document.getElementById("historyList");
  list.innerHTML="";
  let history=JSON.parse(localStorage.getItem("kusuma_history")||"[]");
  history.forEach(item=>{
    const div=document.createElement("div");
    div.className="history-item";
    div.textContent=(item.side==="user"?"üë§":"ü§ñ")+": "+item.text;
    list.appendChild(div);
  });
}

// Profile
function loadProfile(){
  const saved=localStorage.getItem("kusuma_profile");
  if(saved){
    const obj=JSON.parse(saved);
    USER_NAME=obj.name||"Guest";
    AV_USER=obj.avatar||AV_USER;
    document.getElementById("profileName").value=USER_NAME;
    document.getElementById("profilePic").src=AV_USER;
  }
}
function saveProfile(){
  const name=document.getElementById("profileName").value||"Guest";
  USER_NAME=name;
  const obj={name,avatar:AV_USER};
  localStorage.setItem("kusuma_profile",JSON.stringify(obj));
  alert("Profil disimpan!");
}
</script>
</body>
</html>
